<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Administrador</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü¶∑</text></svg>">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      padding-top: 70px;
      background-color: #f8f9fa;
    }
  
    .sidebar {
      background-color: #fff;
      height: 100vh;
      padding-top: 20px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.05);
    }
  
    .sidebar a {
      display: block;
      padding: 10px 20px;
      color: #333;
      text-decoration: none;
      cursor: pointer;
      position: relative;
      transition: all 0.2s ease-in-out;
    }
  
    .sidebar a:hover,
    .sidebar a.active {
      color: #007bff;
    }
  
    .sidebar a::after { 
      content: "";
      position: absolute;
      bottom: 5px;
      left: 20px;
      width: 0;
      height: 2px;
      background-color: #007bff;
      transition: width 0.3s ease-in-out;
    }
  
    .sidebar a:hover::after {
      width: 50px;
    }
  
    .content {
      padding: 20px;
    }

    .card {
      border: none;
      border-radius: 15px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      transition: transform 0.2s ease-in-out;
      background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%);
      color: white;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 12px rgba(13, 110, 253, 0.2);
    }

    .card-title {
      color: rgba(255, 255, 255, 0.9);
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 1rem;
    }

    .card-text {
      font-size: 2.5rem;
      font-weight: 600;
      color: white;
      margin: 0;
    }

    .card-subtitle {
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.9rem;
    }

    .saudacao {
      color: #2c3e50;
      font-weight: 600;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid #e9ecef;
    }

    .saudacao i {
      color: #0d6efd;
      margin-right: 10px;
    }

    /* NOVO CSS ADICIONADO */
    .centralizar-formulario {
      max-width: 500px;
      margin: 0 auto;
    }

    .nav-tabs .nav-link {
      color: #495057;
    }

    .nav-tabs .nav-link.active {
      color: #007bff;
      font-weight: 500;
    }

    .divisor-secao {
      border-bottom: 2px solid #e9ecef;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
    }
  </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" href="#">Odonto Vida - Admin</a>
    <div class="ms-auto">
      <a href="index.html" class="btn btn-outline-light" onclick="localStorage.clear()">Sair</a>
    </div>
  </div>
</nav>

<div class="container-fluid">
  <div class="row">
    <!-- Sidebar -->
    <div class="col-md-2 sidebar">
      <a onclick="carregarConteudo('visaoGeral', this)" class="active">
        <i class="fas fa-chart-line"></i> Vis√£o Geral
      </a>
      <a onclick="carregarConteudo('admin', this)">
        <i class="fas fa-user-shield"></i> Gerenciar Admin
      </a>
      <a onclick="carregarConteudo('pacientes', this)">
        <i class="fas fa-users"></i> Gerenciar Pacientes
      </a>
      <a onclick="carregarConteudo('funcionarios', this)">
        <i class="fas fa-user-md"></i> Gerenciar Funcion√°rios
      </a>
      <a onclick="carregarConteudo('relatorios', this)">
        <i class="fas fa-file-alt"></i> Relat√≥rios
      </a>
    </div>

    <!-- Conte√∫do -->
    <div class="col-md-10 content">
      <h2 id="saudacao-admin">Bem-vindo, nome!</h2>
      <div id="conteudo-dinamico" class="mt-4"></div>
    </div>
  </div>
</div>

<script>
  // Fun√ß√µes globais
  const nome = localStorage.getItem("nomeAdmin");
  if (nome) {
    document.getElementById("saudacao-admin").innerText = `Bem-vindo, ${nome}!`;
  }

  // Fun√ß√£o de listar pacientes movida para o escopo global
  async function listarPacientes() {
    console.log("Fun√ß√£o listarPacientes chamada");
    const pacienteList = document.getElementById("pacienteList");
    
    try {
      const response = await fetch("http://localhost:8080/paciente/listar", {
        method: 'GET',
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        }
      });
      
      if (!response.ok) {
        throw new Error(`Erro na requisi√ß√£o: ${response.status}`);
      }
      
      const data = await response.json();
      
      let html = `
        <h5>Pacientes Cadastrados</h5>
        <table class="table table-bordered table-hover mt-3">
          <thead class="table-light">
            <tr>
              <th>Nome</th>
              <th>CPF</th>
              <th>Data de Nascimento</th>
              <th>Email</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
      `;

      if (!data || data.length === 0) {
        html += `
          <tr>
            <td colspan="5" class="text-center">Nenhum paciente cadastrado</td>
          </tr>
        `;
      } else {
        data.forEach(pac => {
          html += `
            <tr>
              <td>${pac.nome || '-'}</td>
              <td>${pac.cpf || '-'}</td>
              <td>${pac.dataNascimento || '-'}</td>
              <td>${pac.email || '-'}</td>
              <td>
                <button class="btn btn-warning btn-sm me-2" onclick="editarPaciente(${pac.id}, '${pac.nome || ''}', '${pac.cpf || ''}', '${pac.dataNascimento || ''}', '${pac.email || ''}')">Editar</button>
                <button class="btn btn-danger btn-sm" onclick="deletarPaciente(${pac.id})">Excluir</button>
              </td>
            </tr>
          `;
        });
      }

      html += `</tbody></table>`;
      pacienteList.innerHTML = html;
    } catch (error) {
      console.error("Erro ao listar pacientes:", error);
      pacienteList.innerHTML = `
        <div class="alert alert-danger" role="alert">
          <h5>Erro ao buscar pacientes</h5>
          <p>${error.message}</p>
          <p>Por favor, verifique se o servidor est√° rodando e tente novamente.</p>
        </div>
      `;
    }
  }

  // Fun√ß√£o de carregar conte√∫do
  async function carregarConteudo(secao, linkElement) {
    // Remove active class from all links
    document.querySelectorAll('.sidebar a').forEach(link => {
      link.classList.remove('active');
    });
    
    // Add active class to clicked link
    if (linkElement) {
      linkElement.classList.add('active');
    }

    const conteudo = document.getElementById("conteudo-dinamico");

    if (secao === "visaoGeral") {
      try {
        // Buscar total de pacientes
        const responsePacientes = await fetch("http://localhost:8080/paciente/listar", {
          method: 'GET',
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
          }
        });

        // Buscar total de funcion√°rios
        const responseFuncionarios = await fetch("http://localhost:8080/funcionarios/listar", {
          method: 'GET',
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
          }
        });

        // Buscar consultas
        const responseConsultas = await fetch("http://localhost:8080/consultas/listar", {
          method: 'GET',
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
          }
        });

        if (!responsePacientes.ok || !responseFuncionarios.ok || !responseConsultas.ok) {
          throw new Error("Erro ao buscar dados");
        }

        const pacientes = await responsePacientes.json();
        const funcionarios = await responseFuncionarios.json();
        const consultas = await responseConsultas.json();

        // Calcular indicadores de agendamento
        const hoje = new Date().toISOString().split('T')[0];
        const consultasHoje = consultas.filter(c => c.data === hoje && c.status !== 'CANCELADA').length;
        
        // Pr√≥ximas 7 consultas
        const proximasConsultas = consultas
          .filter(c => c.data >= hoje && c.status !== 'CANCELADA')
          .sort((a, b) => new Date(a.data + 'T' + a.horario) - new Date(b.data + 'T' + b.horario))
          .slice(0, 7);

        // Calcular taxa de ocupa√ß√£o (considerando 8 horas de trabalho, 1 hora por consulta)
        const horarioInicio = 8; // 8:00
        const horarioFim = 18; // 18:00
        const totalSlots = horarioFim - horarioInicio; // 1 slot por hora
        const taxaOcupacao = ((consultasHoje / totalSlots) * 100).toFixed(1);

        conteudo.innerHTML = `
          <div class="divisor-secao"></div>
          <div class="row">
            <div class="col-md-6 mb-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title">
                    <i class="fas fa-users"></i>
                    Total de Pacientes
                  </h5>
                  <p class="card-text">${pacientes.length}</p>
                  <p class="card-subtitle">Pacientes cadastrados no sistema</p>
                </div>
              </div>
            </div>
            <div class="col-md-6 mb-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title">
                    <i class="fas fa-user-md"></i>
                    Total de Funcion√°rios
                  </h5>
                  <p class="card-text">${funcionarios.length}</p>
                  <p class="card-subtitle">Profissionais ativos na cl√≠nica</p>
                </div>
              </div>
            </div>
          </div>

          <h5 class="mt-4 mb-3 text-muted">Indicadores de Agendamento</h5>
          <div class="row">
            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title">
                    <i class="fas fa-calendar-day"></i>
                    Consultas Hoje
                  </h5>
                  <p class="card-text">${consultasHoje}</p>
                  <p class="card-subtitle">Consultas agendadas para hoje</p>
                </div>
              </div>
            </div>
            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title">
                    <i class="fas fa-calendar-week"></i>
                    Pr√≥ximas Consultas
                  </h5>
                  <div class="list-group list-group-flush bg-transparent">
                    ${proximasConsultas.map(consulta => `
                      <div class="list-group-item bg-transparent border-0 px-0 py-1">
                        <small class="text-white-50">${consulta.data} ${consulta.horario}</small>
                        <div class="d-flex justify-content-between align-items-center">
                          <span class="text-white">${consulta.nome}</span>
                          <span class="badge bg-white text-primary">${consulta.servico}</span>
                        </div>
                      </div>
                    `).join('')}
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title">
                    <i class="fas fa-chart-line"></i>
                    Taxa de Ocupa√ß√£o
                  </h5>
                  <p class="card-text">${taxaOcupacao}%</p>
                  <p class="card-subtitle">Ocupa√ß√£o da agenda de hoje (slots de 1 hora)</p>
                  <div class="progress mt-2" style="height: 5px;">
                    <div class="progress-bar bg-white" role="progressbar" 
                         style="width: ${taxaOcupacao}%" 
                         aria-valuenow="${taxaOcupacao}" 
                         aria-valuemin="0" 
                         aria-valuemax="100">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `;
      } catch (error) {
        console.error("Erro ao carregar dados:", error);
        conteudo.innerHTML = `
          <div class="alert alert-danger" role="alert">
            <h5>Erro ao carregar dados</h5>
            <p>N√£o foi poss√≠vel carregar os dados da vis√£o geral.</p>
            <p>Por favor, verifique se o servidor est√° rodando e tente novamente.</p>
          </div>
        `;
      }
    }

    if (secao === "admin") {
      conteudo.innerHTML = `
        <div class="mb-3">
          <div class="input-group">
            <input type="search" id="pesquisaAdmin" class="form-control" placeholder="Pesquisar por nome..." onkeyup="filtrarAdmins()" autocomplete="off">
            <span class="input-group-text"><i class="fas fa-search"></i></span>
            <button class="btn btn-success" onclick="document.getElementById('formAdmin').classList.toggle('d-none')">
              <i class="fas fa-plus"></i> Novo
            </button>
          </div>
        </div>

        <div id="formAdmin" class="card shadow-sm d-none mb-4">
          <div class="card-header bg-primary text-white">
            <h5 class="card-title mb-0">
              <i class="fas fa-user-shield me-2"></i>Novo Administrador
            </h5>
          </div>
          <div class="card-body">
            <div id="mensagemCriacao" class="alert d-none mb-4" role="alert"></div>
            
            <form class="row g-3">
              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="text" id="nome" class="form-control" placeholder="Digite o nome completo" required>
                  <label for="nome"><i class="fas fa-user me-2"></i>Nome Completo</label>
                </div>
              </div>
              
              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="email" id="email" class="form-control" placeholder="Digite o email" required>
                  <label for="email"><i class="fas fa-envelope me-2"></i>Email</label>
                </div>
              </div>

              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="date" id="dataNascimento" class="form-control" placeholder="Selecione a data de nascimento" required>
                  <label for="dataNascimento"><i class="fas fa-calendar me-2"></i>Data de Nascimento</label>
                </div>
              </div>

              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="password" id="senha" class="form-control" placeholder="Digite a senha" required>
                  <label for="senha"><i class="fas fa-lock me-2"></i>Senha</label>
                </div>
              </div>

              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="password" id="confirmarSenha" class="form-control" placeholder="Confirme a senha" required>
                  <label for="confirmarSenha"><i class="fas fa-lock me-2"></i>Confirmar Senha</label>
                </div>
              </div>

              <div class="col-12 text-end">
                <button type="button" class="btn btn-secondary me-2" onclick="document.getElementById('formAdmin').classList.add('d-none')">
                  <i class="fas fa-times me-2"></i>Cancelar
                </button>
                <button type="button" class="btn btn-primary" onclick="criarAdmin()">
                  <i class="fas fa-save me-2"></i>Salvar
                </button>
              </div>
            </form>
          </div>
        </div>

        <div class="mt-4" id="adminList"></div>
      `;
      // Listar admins automaticamente
      listarAdmins();
    }
    if (secao === "funcionarios") {
      conteudo.innerHTML = `
        <div class="mb-3">
          <div class="input-group">
            <input type="search" 
              id="pesquisaFuncionario" 
              name="search-funcionario-${Date.now()}" 
              class="form-control" 
              placeholder="Pesquisar por nome ou CPF..." 
              onkeyup="filtrarFuncionarios()" 
              autocomplete="new-password"
              autocorrect="off"
              autocapitalize="off"
              spellcheck="false"
              readonly
              onfocus="this.removeAttribute('readonly')">
            <span class="input-group-text"><i class="fas fa-search"></i></span>
            <button class="btn btn-success" onclick="document.getElementById('formFuncionario').classList.toggle('d-none')">
              <i class="fas fa-plus"></i> Novo
            </button>
          </div>
        </div>

        <div id="formFuncionario" class="card shadow-sm d-none mb-4">
          <div class="card-header bg-primary text-white">
            <h5 class="card-title mb-0">
              <i class="fas fa-user-md me-2"></i>Novo Funcion√°rio
            </h5>
          </div>
          <div class="card-body">
            <div id="mensagemFuncionario" class="alert d-none mb-4" role="alert"></div>
            
            <form class="row g-3">
              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="text" id="funcNome" class="form-control" placeholder="Digite o nome completo" required>
                  <label for="funcNome"><i class="fas fa-user me-2"></i>Nome Completo</label>
                </div>
              </div>

              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="text" id="funcCpf" class="form-control" placeholder="Digite o CPF" required>
                  <label for="funcCpf"><i class="fas fa-id-card me-2"></i>CPF</label>
                </div>
              </div>

              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="text" id="funcCro" class="form-control" placeholder="Digite o CRO" required>
                  <label for="funcCro"><i class="fas fa-stethoscope me-2"></i>CRO</label>
                </div>
              </div>

              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="email" id="funcEmail" class="form-control" placeholder="Digite o email" required>
                  <label for="funcEmail"><i class="fas fa-envelope me-2"></i>Email</label>
                </div>
              </div>

              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="password" id="funcSenha" class="form-control" placeholder="Digite a senha" required>
                  <label for="funcSenha"><i class="fas fa-lock me-2"></i>Senha</label>
                </div>
              </div>

              <div class="col-md-6">
                <div class="form-floating mb-3">
                  <input type="password" id="funcConfirmarSenha" class="form-control" placeholder="Confirme a senha" required>
                  <label for="funcConfirmarSenha"><i class="fas fa-lock me-2"></i>Confirmar Senha</label>
                </div>
              </div>

              <div class="col-12 text-end">
                <button type="button" class="btn btn-secondary me-2" onclick="document.getElementById('formFuncionario').classList.add('d-none')">
                  <i class="fas fa-times me-2"></i>Cancelar
                </button>
                <button type="button" class="btn btn-primary" onclick="criarFuncionario()">
                  <i class="fas fa-save me-2"></i>Salvar
                </button>
              </div>
            </form>
          </div>
        </div>

        <div class="mt-4" id="funcionarioList"></div>
      `;
      // Listar funcion√°rios automaticamente
      listarFuncionarios();
    }
    if (secao === "pacientes") {
      conteudo.innerHTML = `
        <div class="mb-3">
          <div class="input-group">
            <input type="search" id="pesquisaPaciente" class="form-control" 
              placeholder="Pesquisar por nome ou CPF..." 
              onkeyup="filtrarPacientes()" 
              autocomplete="off"
              autocorrect="off"
              autocapitalize="off"
              spellcheck="false">
            <span class="input-group-text"><i class="fas fa-search"></i></span>
          </div>
        </div>

        <div class="mt-4" id="pacienteList"></div>
      `;
      // Listar pacientes automaticamente
      listarPacientes();
    }
    if (secao === "relatorios") {
      conteudo.innerHTML = `
        <div class="divisor-secao">
          <h4 class="mb-4">Relat√≥rio de Consultas</h4>
          
          <!-- Filtros -->
          <div class="card shadow-sm mb-4">
            <div class="card-body">
              <form id="formFiltroRelatorio" class="row g-3">
                <div class="col-md-3">
                  <label class="form-label">Tipo de Per√≠odo</label>
                  <select class="form-select" id="tipoPeriodo" onchange="atualizarFiltrosPeriodo()">
                    <option value="diario">Di√°rio</option>
                    <option value="semanal">Semanal</option>
                    <option value="mensal">Mensal</option>
                    <option value="anual">Anual</option>
                    <option value="personalizado">Personalizado</option>
                  </select>
                </div>
                
                <div class="col-md-3" id="filtroDataInicial">
                  <label class="form-label">Data Inicial</label>
                  <input type="date" class="form-control" id="dataInicial">
                </div>
                
                <div class="col-md-3" id="filtroDataFinal">
                  <label class="form-label">Data Final</label>
                  <input type="date" class="form-control" id="dataFinal">
                </div>
                
                <div class="col-md-3 d-flex align-items-end">
                  <button type="button" class="btn btn-primary w-100" onclick="gerarRelatorioConsultas()">
                    <i class="fas fa-search me-2"></i>Gerar Relat√≥rio
                  </button>
                </div>
              </form>
            </div>
          </div>

          <!-- Cards de Resumo -->
          <div class="row mb-4">
            <div class="col-md-3">
              <div class="card h-100">
                <div class="card-body">
                  <h6 class="card-title text-white">Total de Consultas</h6>
                  <h2 class="card-text text-white" id="totalConsultas">0</h2>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card h-100">
                <div class="card-body">
                  <h6 class="card-title text-white">Taxa de Comparecimento</h6>
                  <h2 class="card-text text-white" id="taxaComparecimento">0%</h2>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card h-100">
                <div class="card-body">
                  <h6 class="card-title text-white">Hor√°rio Mais Popular</h6>
                  <h2 class="card-text text-white" id="horarioPopular">-</h2>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card h-100">
                <div class="card-body">
                  <h6 class="card-title text-white">Servi√ßo Mais Solicitado</h6>
                  <h2 class="card-text text-white" id="servicoPopular">-</h2>
                </div>
              </div>
            </div>
          </div>

          <!-- Gr√°ficos -->
          <div class="row mb-4">
            <div class="col-md-6">
              <div class="card h-100 border-0 shadow-sm bg-primary">
                <div class="card-body">
                  <h5 class="card-title d-flex align-items-center mb-4 text-white">
                    <i class="bi bi-bar-chart-line me-2 text-white"></i>
                    Consultas por Per√≠odo
                  </h5>
                  <div style="height: 250px;">
                    <canvas id="graficoConsultasPeriodo"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card h-100 border-0 shadow-sm bg-primary">
                <div class="card-body">
                  <h5 class="card-title d-flex align-items-center mb-4 text-white">
                    <i class="bi bi-pie-chart me-2 text-white"></i>
                    Taxa de Comparecimento
                  </h5>
                  <div style="height: 250px;">
                    <canvas id="graficoComparecimento"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row mb-4">
            <div class="col-md-6">
              <div class="card h-100 border-0 shadow-sm bg-primary">
                <div class="card-body">
                  <h5 class="card-title d-flex align-items-center mb-4 text-white">
                    <i class="bi bi-clock-history me-2 text-white"></i>
                    Hor√°rios Mais Populares
                  </h5>
                  <div style="height: 250px;">
                    <canvas id="graficoHorarios"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card h-100 border-0 shadow-sm bg-primary">
                <div class="card-body">
                  <h5 class="card-title d-flex align-items-center mb-4 text-white">
                    <i class="bi bi-star me-2 text-white"></i>
                    Servi√ßos Mais Solicitados
                  </h5>
                  <div style="height: 250px;">
                    <canvas id="graficoServicos"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Tabela de Dados -->
          <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title mb-3">Dados Detalhados</h5>
                <div id="filtrosTabela" class="mb-3">
                    <!-- Filtros ser√£o inseridos aqui via JavaScript -->
                </div>
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <small class="text-white" id="contadorResultados"></small>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Hor√°rio</th>
                                <th>Paciente</th>
                                <th>Dentista</th>
                                <th>Servi√ßo</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaConsultasBody">
                            <!-- Dados ser√£o inseridos via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
      `;

      // Inicializar os filtros de data
      atualizarFiltrosPeriodo();
    }
  }

  async function listarAdmins() {
    try {
      const response = await fetch("http://localhost:8080/administrador/administradores");
      const data = await response.json();

      let html = `
        <h5>Administradores Cadastrados</h5>
        <table class="table table-bordered table-hover mt-3">
          <thead class="table-light">
            <tr>
              <th>Nome</th>
              <th>Email</th>
              <th>Data de Nascimento</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
      `;

      data.forEach(admin => {
        html += `
          <tr>
            <td>${admin.nome}</td>
            <td>${admin.email}</td>
            <td>${admin.dataNascimento}</td>
            <td>
              <button class="btn btn-warning btn-sm me-2" onclick="editarAdmin(${admin.id}, '${admin.nome}', '${admin.email}', '${admin.dataNascimento}')">Editar</button>
              <button class="btn btn-danger btn-sm" onclick="deletarAdmin(${admin.id})">Excluir</button>
            </td>
          </tr>
        `;
      });

      html += `</tbody></table>`;
      document.getElementById("adminList").innerHTML = html;
    } catch (error) {
      alert("Erro ao buscar administradores.");
    }
  }

  function editarAdmin(id, nomeAtual, emailAtual, dataNascimentoAtual) {
    document.getElementById("editarId").value = id;
    document.getElementById("editarNome").value = nomeAtual;
    document.getElementById("editarEmail").value = emailAtual;
    document.getElementById("editarDataNascimento").value = dataNascimentoAtual;
    document.getElementById("editarSenha").value = "";
    document.getElementById("mensagemEdicao").className = "alert d-none";
    document.getElementById("mensagemEdicao").innerText = "";

    const modal = new bootstrap.Modal(document.getElementById("modalEditarAdmin"));
    modal.show();
  }

  async function verificarEmailExistente(email, idAtual, tipo) {
    try {
        // Verificar em administradores
        const responseAdmins = await fetch("http://localhost:8080/administrador/administradores");
        if (!responseAdmins.ok) throw new Error("Erro ao verificar administradores");
        const admins = await responseAdmins.json();
        if (admins.some(a => a.email === email && a.id !== parseInt(idAtual))) return true;

        // Verificar em pacientes
        const responsePacientes = await fetch("http://localhost:8080/paciente/listar");
        if (!responsePacientes.ok) throw new Error("Erro ao verificar pacientes");
        const pacientes = await responsePacientes.json();
        if (pacientes.some(p => p.email === email && p.id !== parseInt(idAtual))) return true;

        // Verificar em funcion√°rios
        const responseFuncionarios = await fetch("http://localhost:8080/funcionarios/listar");
        if (!responseFuncionarios.ok) throw new Error("Erro ao verificar funcion√°rios");
        const funcionarios = await responseFuncionarios.json();
        if (funcionarios.some(f => f.email === email && f.id !== parseInt(idAtual))) return true;

        return false;
    } catch (error) {
        console.error("Erro ao verificar email:", error);
        throw error;
    }
  }

  async function salvarEdicao() {
    const id = document.getElementById("editarId").value;
    const nome = document.getElementById("editarNome").value.trim();
    const email = document.getElementById("editarEmail").value.trim();
    const dataNascimento = document.getElementById("editarDataNascimento").value;
    const senha = document.getElementById("editarSenha").value.trim();
    const mensagemDiv = document.getElementById("mensagemEdicao");

    mensagemDiv.className = "alert d-none";
    mensagemDiv.innerText = "";

    if (!nome || !email || !dataNascimento) {
        mensagemDiv.className = "alert alert-warning";
        mensagemDiv.innerText = "Preencha todos os campos obrigat√≥rios.";
        return;
    }

    const idade = verificaMaiorDeIdade(dataNascimento);
    if (idade < 18) {
        mensagemDiv.className = "alert alert-danger";
        mensagemDiv.innerText = "O administrador precisa ter pelo menos 18 anos.";
        return;
    }

    try {
        // Verificar email duplicado
        const emailExiste = await verificarEmailExistente(email, id, 'admin');
        if (emailExiste) {
            mensagemDiv.className = "alert alert-danger";
            mensagemDiv.innerText = "Este email j√° est√° cadastrado.";
            return;
        }

        const body = { nome, email, dataNascimento };
        if (senha) body.senha = senha;

        const updateResponse = await fetch(`http://localhost:8080/administrador/atualizar/${id}`, {
            method: "PUT",
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        });

        if (!updateResponse.ok) {
            const errorData = await updateResponse.text();
            if (errorData.includes("Unique index or primary key violation")) {
                mensagemDiv.className = "alert alert-danger";
                mensagemDiv.innerText = "Este email j√° est√° cadastrado.";
            } else {
                mensagemDiv.className = "alert alert-danger";
                mensagemDiv.innerText = "Erro ao atualizar administrador.";
            }
            return;
        }

        mensagemDiv.className = "alert alert-success";
        mensagemDiv.innerText = "Administrador atualizado com sucesso!";
        setTimeout(() => {
            bootstrap.Modal.getInstance(document.getElementById("modalEditarAdmin")).hide();
            listarAdmins();
        }, 2000);
    } catch (error) {
        console.error("Erro:", error);
        mensagemDiv.className = "alert alert-danger";
        mensagemDiv.innerText = "Erro de conex√£o com o servidor.";
    }
  }

  function deletarAdmin(id) {
    if (!confirm("Tem certeza que deseja excluir este administrador?")) return;

    fetch(`http://localhost:8080/administrador/deletar/${id}`, {
      method: "DELETE"
    })
    .then(response => {
      if (response.ok) {
        alert("Administrador exclu√≠do com sucesso.");
        listarAdmins();
      } else {
        alert("Erro ao excluir administrador.");
      }
    })
    .catch(() => alert("Erro de conex√£o com o servidor."));
  }

  function verificaMaiorDeIdade(dataNascimento) {
    const hoje = new Date();
    const nascimento = new Date(dataNascimento);
    let idade = hoje.getFullYear() - nascimento.getFullYear();
    const mes = hoje.getMonth() - nascimento.getMonth();

    if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
      idade--;
    }
    return idade;
  }

  async function criarAdmin() {
    const nome = document.getElementById("nome").value.trim();
    const email = document.getElementById("email").value.trim();
    const dataNascimento = document.getElementById("dataNascimento").value;
    const senha = document.getElementById("senha").value;
    const confirmarSenha = document.getElementById("confirmarSenha").value;
    const mensagemCriacao = document.getElementById("mensagemCriacao");

    // Limpa e esconde a mensagem antes de validar
    mensagemCriacao.className = "alert d-none";
    mensagemCriacao.innerText = "";

    if (!nome || !email || !dataNascimento || !senha || !confirmarSenha) {
      mensagemCriacao.className = "alert alert-warning";
      mensagemCriacao.innerText = "Todos os campos devem ser preenchidos!";
      return;
    }

    const idade = verificaMaiorDeIdade(dataNascimento);
    if (idade < 18) {
      mensagemCriacao.className = "alert alert-danger";
      mensagemCriacao.innerText = "O administrador precisa ter pelo menos 18 anos.";
      return;
    }

    if (senha !== confirmarSenha) {
      mensagemCriacao.className = "alert alert-danger";
      mensagemCriacao.innerText = "As senhas n√£o coincidem!";
      return;
    }

    const body = { nome, email, dataNascimento, senha };

    try {
      const response = await fetch("http://localhost:8080/administrador/criar", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });

      if (response.ok) {
        mensagemCriacao.className = "alert alert-success";
        mensagemCriacao.innerText = "Administrador criado com sucesso!";

        document.getElementById("nome").value = "";
        document.getElementById("email").value = "";
        document.getElementById("dataNascimento").value = "";
        document.getElementById("senha").value = "";
        document.getElementById("confirmarSenha").value = "";

        setTimeout(() => {
          document.getElementById("formAdmin").classList.add("d-none");
          mensagemCriacao.className = "alert d-none";
          listarAdmins();
        }, 2000);
      } else {
        const erro = await response.text();
        mensagemCriacao.className = "alert alert-danger";
        mensagemCriacao.innerText = "Erro ao criar administrador: " + erro;
      }
    } catch (error) {
      mensagemCriacao.className = "alert alert-danger";
      mensagemCriacao.innerText = "Erro de conex√£o com o servidor.";
    }
  }

  async function criarFuncionario() {
    const nome = document.getElementById("funcNome").value.trim();
    const cpf = document.getElementById("funcCpf").value.trim();
    const cro = document.getElementById("funcCro").value.trim();
    const email = document.getElementById("funcEmail").value.trim();
    const senha = document.getElementById("funcSenha").value.trim();
    const confirmarSenha = document.getElementById("funcConfirmarSenha").value.trim();
    const mensagem = document.getElementById("mensagemFuncionario");

    mensagem.className = "alert d-none";
    mensagem.innerText = "";

    if (!nome || !cpf || !cro || !email || !senha || !confirmarSenha) {
      mensagem.className = "alert alert-warning";
      mensagem.innerText = "Todos os campos devem ser preenchidos!";
      return;
    }

    if (senha !== confirmarSenha) {
      mensagem.className = "alert alert-danger";
      mensagem.innerText = "As senhas n√£o coincidem!";
      return;
    }

    try {
      // Verificar se o CPF j√° existe em pacientes
      const responsePacientes = await fetch("http://localhost:8080/paciente/listar", {
        method: 'GET',
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        }
      });

      if (!responsePacientes.ok) {
        throw new Error("Erro ao verificar CPF");
      }

      const pacientes = await responsePacientes.json();
      const cpfExistente = pacientes.find(p => p.cpf === cpf);

      if (cpfExistente) {
        mensagem.className = "alert alert-danger";
        mensagem.innerText = "Este CPF j√° est√° cadastrado como paciente.";
        return;
      }

      // Verificar se o email j√° existe como administrador
      const responseAdmins = await fetch("http://localhost:8080/administrador/administradores", {
        method: 'GET',
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        }
      });

      if (!responseAdmins.ok) {
        throw new Error("Erro ao verificar email");
      }

      const admins = await responseAdmins.json();
      const emailAdminExistente = admins.find(a => a.email === email);

      if (emailAdminExistente) {
        mensagem.className = "alert alert-danger";
        mensagem.innerText = "Este email j√° est√° cadastrado como administrador.";
        return;
      }

      // Se o CPF e email n√£o existem, prosseguir com a cria√ß√£o do funcion√°rio
      const body = { nome, cpf, cro, email, senha };

      const response = await fetch("http://localhost:8080/funcionarios/criar", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });

      if (response.ok) {
        mensagem.className = "alert alert-success";
        mensagem.innerText = "Funcion√°rio cadastrado com sucesso!";
        document.getElementById("funcNome").value = "";
        document.getElementById("funcCpf").value = "";
        document.getElementById("funcCro").value = "";
        document.getElementById("funcEmail").value = "";
        document.getElementById("funcSenha").value = "";
        document.getElementById("funcConfirmarSenha").value = "";
        
        setTimeout(() => {
          document.getElementById("formFuncionario").classList.add("d-none");
          mensagem.className = "alert d-none";
          listarFuncionarios();
        }, 2000);
      } else {
        const erro = await response.text();
        mensagem.className = "alert alert-danger";
        mensagem.innerText = `Erro: ${erro}`;
      }
    } catch (e) {
      mensagem.className = "alert alert-danger";
      mensagem.innerText = "Erro de conex√£o com o servidor.";
    }
  }

  async function listarFuncionarios() {
    try {
      const response = await fetch("http://localhost:8080/funcionarios/listar");
      const data = await response.json();

      let html = `
        <h5>Funcion√°rios Cadastrados</h5>
        <table class="table table-bordered table-hover mt-3">
          <thead class="table-light">
            <tr>
              <th>Nome</th>
              <th>CPF</th>
              <th>CRO</th>
              <th>Email</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
      `;

      data.forEach(func => {
        html += `
          <tr>
            <td>${func.nome}</td>
            <td>${func.cpf}</td>
            <td>${func.cro}</td>
            <td>${func.email}</td>
            <td>
              <button class="btn btn-warning btn-sm me-2" onclick="editarFuncionario(${func.id}, '${func.nome}', '${func.cpf}', '${func.cro}', '${func.email}')">Editar</button>
              <button class="btn btn-danger btn-sm" onclick="deletarFuncionario(${func.id})">Excluir</button>
            </td>
          </tr>
        `;
      });

      html += `</tbody></table>`;
      document.getElementById("funcionarioList").innerHTML = html;
    } catch (error) {
      alert("Erro ao buscar funcion√°rios.");
    }
  }

  function editarFuncionario(id, nome, cpf, cro, email) {
    document.getElementById("funcEditarId").value = id;
    document.getElementById("funcEditarNome").value = nome;
    document.getElementById("funcEditarCpf").value = cpf;
    document.getElementById("funcEditarCro").value = cro;
    document.getElementById("funcEditarEmail").value = email;
    document.getElementById("funcEditarSenha").value = "";
    document.getElementById("mensagemEdicaoFuncionario").className = "alert d-none";
    document.getElementById("mensagemEdicaoFuncionario").innerText = "";

    const modal = new bootstrap.Modal(document.getElementById("modalEditarFuncionario"));
    modal.show();
  }

  async function salvarEdicaoFuncionario() {
    const id = document.getElementById("funcEditarId").value;
    const nome = document.getElementById("funcEditarNome").value.trim();
    const cpf = document.getElementById("funcEditarCpf").value.trim();
    const cro = document.getElementById("funcEditarCro").value.trim();
    const email = document.getElementById("funcEditarEmail").value.trim();
    const senha = document.getElementById("funcEditarSenha").value.trim();
    const mensagem = document.getElementById("mensagemEdicaoFuncionario");

    mensagem.className = "alert d-none";
    mensagem.innerText = "";

    if (!nome || !cpf || !cro || !email) {
        mensagem.className = "alert alert-warning";
        mensagem.innerText = "Todos os campos obrigat√≥rios devem ser preenchidos.";
        return;
    }

    try {
        // Verificar email duplicado
        const emailExiste = await verificarEmailExistente(email, id, 'funcionario');
        if (emailExiste) {
            mensagem.className = "alert alert-danger";
            mensagem.innerText = "Este email j√° est√° cadastrado.";
            return;
        }

        // Verificar CPF duplicado
        const responseFuncionarios = await fetch("http://localhost:8080/funcionarios/listar");
        if (!responseFuncionarios.ok) throw new Error("Erro ao verificar CPF");
        const funcionarios = await responseFuncionarios.json();
        const cpfExistente = funcionarios.find(f => f.cpf === cpf && f.id !== parseInt(id));
        if (cpfExistente) {
            mensagem.className = "alert alert-danger";
            mensagem.innerText = "Este CPF j√° est√° cadastrado.";
            return;
        }

        const body = { nome, cpf, cro, email };
        if (senha) body.senha = senha;

        const updateResponse = await fetch(`http://localhost:8080/funcionarios/atualizar/${id}`, {
            method: "PUT",
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        });

        if (updateResponse.ok) {
            mensagem.className = "alert alert-success";
            mensagem.innerText = "Funcion√°rio atualizado com sucesso!";
            setTimeout(() => {
                bootstrap.Modal.getInstance(document.getElementById("modalEditarFuncionario")).hide();
                listarFuncionarios();
            }, 2000);
        } else {
            mensagem.className = "alert alert-danger";
            mensagem.innerText = "Erro ao atualizar funcion√°rio.";
        }
    } catch (error) {
        console.error("Erro:", error);
        mensagem.className = "alert alert-danger";
        mensagem.innerText = "Erro de conex√£o com o servidor.";
    }
  }

  async function deletarFuncionario(id) {
    if (!confirm("Tem certeza que deseja excluir este funcion√°rio?")) return;

    try {
      const response = await fetch(`http://localhost:8080/funcionarios/deletar/${id}`, {
        method: "DELETE"
      });

      if (response.ok) {
        alert("Funcion√°rio exclu√≠do com sucesso!");
        listarFuncionarios();
      } else {
        alert("Erro ao excluir funcion√°rio.");
      }
    } catch (error) {
      alert("Erro de conex√£o com o servidor.");
    }
  }

  async function editarPaciente(id, nome, cpf, dataNascimento, email) {
    document.getElementById("pacEditarId").value = id;
    document.getElementById("pacEditarNome").value = nome;
    document.getElementById("pacEditarCpf").value = cpf;
    document.getElementById("pacEditarDataNascimento").value = dataNascimento;
    document.getElementById("pacEditarEmail").value = email;
    document.getElementById("pacEditarSenha").value = "********";
    document.getElementById("mensagemEdicaoPaciente").className = "alert d-none";
    document.getElementById("mensagemEdicaoPaciente").innerText = "";

    const modal = new bootstrap.Modal(document.getElementById("modalEditarPaciente"));
    modal.show();
  }

  function verificaIdadeMinima(dataNascimento, idadeMinima) {
    const hoje = new Date();
    const nascimento = new Date(dataNascimento);
    let idade = hoje.getFullYear() - nascimento.getFullYear();
    const mes = hoje.getMonth() - nascimento.getMonth();

    if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
      idade--;
    }
    return idade >= idadeMinima;
  }

  async function salvarEdicaoPaciente() {
    const id = document.getElementById("pacEditarId").value;
    const nome = document.getElementById("pacEditarNome").value.trim();
    const cpf = document.getElementById("pacEditarCpf").value.trim();
    const dataNascimento = document.getElementById("pacEditarDataNascimento").value;
    const email = document.getElementById("pacEditarEmail").value.trim();
    const mensagem = document.getElementById("mensagemEdicaoPaciente");

    mensagem.className = "alert d-none";
    mensagem.innerText = "";

    if (!nome || !cpf || !dataNascimento || !email) {
        mensagem.className = "alert alert-warning";
        mensagem.innerText = "Todos os campos obrigat√≥rios devem ser preenchidos.";
        return;
    }

    if (!verificaIdadeMinima(dataNascimento, 14)) {
        mensagem.className = "alert alert-danger";
        mensagem.innerText = "O paciente deve ter pelo menos 14 anos de idade.";
        return;
    }

    try {
        // Verificar email duplicado
        const emailExiste = await verificarEmailExistente(email, id, 'paciente');
        if (emailExiste) {
            mensagem.className = "alert alert-danger";
            mensagem.innerText = "Este email j√° est√° cadastrado.";
            return;
        }

        // Verificar CPF duplicado
        const responsePacientes = await fetch("http://localhost:8080/paciente/listar");
        if (!responsePacientes.ok) throw new Error("Erro ao verificar CPF");
        const pacientes = await responsePacientes.json();
        const cpfExistente = pacientes.find(p => p.cpf === cpf && p.id !== parseInt(id));
        if (cpfExistente) {
            mensagem.className = "alert alert-danger";
            mensagem.innerText = "Este CPF j√° est√° cadastrado.";
            return;
        }

        const body = { nome, cpf, dataNascimento, email };
        const updateResponse = await fetch(`http://localhost:8080/paciente/atualizar/${id}`, {
            method: "PUT",
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        });

        if (updateResponse.ok) {
            mensagem.className = "alert alert-success";
            mensagem.innerText = "Paciente atualizado com sucesso!";
            setTimeout(() => {
                bootstrap.Modal.getInstance(document.getElementById("modalEditarPaciente")).hide();
                listarPacientes();
            }, 2000);
        } else {
            mensagem.className = "alert alert-danger";
            mensagem.innerText = "Erro ao atualizar paciente.";
        }
    } catch (error) {
        console.error("Erro:", error);
        mensagem.className = "alert alert-danger";
        mensagem.innerText = "Erro de conex√£o com o servidor.";
    }
  }

  async function deletarPaciente(id) {
    if (!confirm("Tem certeza que deseja excluir este paciente?")) return;

    try {
      const response = await fetch(`http://localhost:8080/paciente/deletar/${id}`, {
        method: "DELETE",
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        }
      });

      if (response.ok) {
        alert("Paciente exclu√≠do com sucesso!");
        listarPacientes();
      } else {
        alert("Erro ao excluir paciente.");
      }
    } catch (error) {
      alert("Erro de conex√£o com o servidor.");
    }
  }

  // Adicionar as fun√ß√µes de filtragem
  function filtrarAdmins() {
    const pesquisa = document.getElementById("pesquisaAdmin").value.toLowerCase();
    const tabela = document.getElementById("adminList");
    const linhas = tabela.getElementsByTagName("tr");

    for (let i = 1; i < linhas.length; i++) {
      const nome = linhas[i].getElementsByTagName("td")[0].textContent.toLowerCase();
      if (nome.includes(pesquisa)) {
        linhas[i].style.display = "";
      } else {
        linhas[i].style.display = "none";
      }
    }
  }

  function filtrarFuncionarios() {
    const pesquisa = document.getElementById("pesquisaFuncionario").value.toLowerCase();
    const tabela = document.getElementById("funcionarioList");
    const linhas = tabela.getElementsByTagName("tr");

    for (let i = 1; i < linhas.length; i++) {
      const nome = linhas[i].getElementsByTagName("td")[0].textContent.toLowerCase();
      const cpf = linhas[i].getElementsByTagName("td")[1].textContent.toLowerCase();
      if (nome.includes(pesquisa) || cpf.includes(pesquisa)) {
        linhas[i].style.display = "";
      } else {
        linhas[i].style.display = "none";
      }
    }
  }

  function filtrarPacientes() {
    const pesquisa = document.getElementById("pesquisaPaciente").value.toLowerCase();
    const tabela = document.getElementById("pacienteList");
    const linhas = tabela.getElementsByTagName("tr");

    for (let i = 1; i < linhas.length; i++) {
      const nome = linhas[i].getElementsByTagName("td")[0].textContent.toLowerCase();
      const cpf = linhas[i].getElementsByTagName("td")[1].textContent.toLowerCase();
      if (nome.includes(pesquisa) || cpf.includes(pesquisa)) {
        linhas[i].style.display = "";
      } else {
        linhas[i].style.display = "none";
      }
    }
  }

  // Adicionar as fun√ß√µes de relat√≥rio
  function atualizarFiltrosPeriodo() {
    const tipoPeriodo = document.getElementById("tipoPeriodo");
    const dataInicial = document.getElementById("dataInicial");
    const dataFinal = document.getElementById("dataFinal");
    const hoje = new Date();

    // Limpar valores anteriores
    dataInicial.value = "";
    dataFinal.value = "";

    // Adicionar evento de mudan√ßa na data inicial
    dataInicial.onchange = function() {
        if (dataFinal.value && dataInicial.value > dataFinal.value) {
            dataFinal.value = dataInicial.value;
        }
        dataFinal.min = dataInicial.value;
    };

    // Adicionar evento de mudan√ßa na data final
    dataFinal.onchange = function() {
        // Se a data final for diferente da inicial, mudar para personalizado
        if (dataInicial.value && dataFinal.value !== dataInicial.value) {
            tipoPeriodo.value = "personalizado";
        }
        
        if (dataInicial.value && dataFinal.value < dataInicial.value) {
            alert("A data final n√£o pode ser menor que a data inicial");
            dataFinal.value = dataInicial.value;
        }
    };

    switch (tipoPeriodo.value) {
        case "diario":
            dataInicial.value = hoje.toISOString().split("T")[0];
            dataFinal.value = hoje.toISOString().split("T")[0];
            break;
        case "semanal":
            const inicioSemana = new Date(hoje.setDate(hoje.getDate() - hoje.getDay()));
            const fimSemana = new Date(hoje.setDate(hoje.getDate() + 6));
            dataInicial.value = inicioSemana.toISOString().split("T")[0];
            dataFinal.value = fimSemana.toISOString().split("T")[0];
            break;
        case "mensal":
            const inicioMes = new Date(hoje.getFullYear(), hoje.getMonth(), 1);
            const fimMes = new Date(hoje.getFullYear(), hoje.getMonth() + 1, 0);
            dataInicial.value = inicioMes.toISOString().split("T")[0];
            dataFinal.value = fimMes.toISOString().split("T")[0];
            break;
        case "anual":
            const inicioAno = new Date(hoje.getFullYear(), 0, 1);
            const fimAno = new Date(hoje.getFullYear(), 11, 31);
            dataInicial.value = inicioAno.toISOString().split("T")[0];
            dataFinal.value = fimAno.toISOString().split("T")[0];
            break;
        case "personalizado":
            // Definir data m√≠nima como hoje para ambos os campos
            const hojeStr = hoje.toISOString().split("T")[0];
            dataInicial.min = hojeStr;
            dataFinal.min = hojeStr;
            break;
    }

    // Atualizar o atributo min da data final baseado na data inicial
    if (dataInicial.value) {
        dataFinal.min = dataInicial.value;
    }
  }

  async function gerarRelatorioConsultas() {
    try {
      // Obter par√¢metros de filtro
      const tipoPeriodo = document.getElementById("tipoPeriodo").value;
      const dataInicio = document.getElementById("dataInicial").value;
      const dataFim = document.getElementById("dataFinal").value;

      console.log("Par√¢metros do relat√≥rio:", { tipoPeriodo, dataInicio, dataFim });

      // Construir URL com par√¢metros
      let url = "http://localhost:8080/consultas/listar"; // Corrigindo a URL do endpoint
      const params = new URLSearchParams();
      
      if (tipoPeriodo === "personalizado") {
        if (!dataInicio || !dataFim) {
          alert("Por favor, selecione as datas de in√≠cio e fim para o per√≠odo personalizado.");
          return;
        }
        params.append("dataInicio", dataInicio);
        params.append("dataFim", dataFim);
      }

      url += "?" + params.toString();
      console.log("URL da requisi√ß√£o:", url);

      // Buscar dados com headers CORS
      const response = await fetch(url, {
        method: 'GET',
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json',
          'Origin': 'http://127.0.0.1:5500'
        },
        mode: 'cors' // Explicitamente definindo o modo CORS
      });

      if (!response.ok) {
        const errorText = await response.text();
        console.error("Erro na resposta do servidor:", {
          status: response.status,
          statusText: response.statusText,
          errorText: errorText
        });
        throw new Error(`Erro ao buscar dados das consultas: ${response.status} ${response.statusText}`);
      }

      const consultas = await response.json();
      console.log("Total de consultas recebidas:", consultas.length);

      // Filtrar consultas pelo per√≠odo selecionado
      const consultasFiltradas = consultas.filter(consulta => {
        const dataConsulta = new Date(consulta.data);
        const dataInicioFiltro = new Date(dataInicio);
        const dataFimFiltro = new Date(dataFim);
        return dataConsulta >= dataInicioFiltro && dataConsulta <= dataFimFiltro;
      });

      console.log("Consultas filtradas para o per√≠odo:", consultasFiltradas.length);

      if (consultasFiltradas.length === 0) {
        alert("N√£o foram encontradas consultas para o per√≠odo selecionado.");
        return;
      }

      // Atualizar cards de resumo
      atualizarCardsResumo(consultasFiltradas);

      // Atualizar gr√°ficos
      atualizarGraficos(consultasFiltradas);

      // Atualizar tabela
      atualizarTabelaConsultas(consultasFiltradas);

    } catch (error) {
      console.error("Erro ao carregar relat√≥rio:", error);
      alert(`Erro ao carregar o relat√≥rio de consultas: ${error.message}`);
    }
  }

  function atualizarCardsResumo(consultas) {
    const agora = new Date();
    
    // Total de Consultas
    const totalConsultas = consultas.length;
    document.getElementById("totalConsultas").textContent = totalConsultas;

    // Taxa de Conclus√£o (consultas conclu√≠das / total de consultas n√£o canceladas)
    const consultasNaoCanceladas = consultas.filter(c => c.status !== 'CANCELADA').length;
    const concluidas = consultas.filter(c => {
        if (c.status === 'CANCELADA') return false;
        const [ano, mes, dia] = c.data.split('-').map(Number);
        const [hora, minuto] = c.horario.split(':').map(Number);
        const dataHoraConsulta = new Date(ano, mes - 1, dia, hora, minuto);
        return dataHoraConsulta < agora;
    }).length;

    const taxaConclusao = consultasNaoCanceladas > 0 
        ? ((concluidas / consultasNaoCanceladas) * 100).toFixed(1) 
        : "0.0";
    document.getElementById("taxaComparecimento").textContent = taxaConclusao + "%";

    // Hor√°rio mais Popular (considerando apenas consultas n√£o canceladas)
    const horarios = {};
    consultas.filter(c => c.status !== 'CANCELADA').forEach(c => {
        horarios[c.horario] = (horarios[c.horario] || 0) + 1;
    });
    const horarioMaisPopular = Object.entries(horarios)
        .sort((a, b) => b[1] - a[1])[0];
    document.getElementById("horarioPopular").textContent = 
        horarioMaisPopular ? horarioMaisPopular[0] : "N/A";

    // Servi√ßo mais Solicitado (considerando apenas consultas n√£o canceladas)
    const servicos = {};
    consultas.filter(c => c.status !== 'CANCELADA').forEach(c => {
        servicos[c.servico] = (servicos[c.servico] || 0) + 1;
    });
    const servicoMaisSolicitado = Object.entries(servicos)
        .sort((a, b) => b[1] - a[1])[0];
    document.getElementById("servicoPopular").textContent = 
        servicoMaisSolicitado ? servicoMaisSolicitado[0] : "N/A";
  }

  function atualizarGraficos(consultas) {
    // Destruir gr√°ficos existentes
    Object.values(Chart.instances).forEach(chart => chart.destroy());

    // Preparar dados para os gr√°ficos
    const dadosPorPeriodo = prepararDadosPorPeriodo(consultas);
    const dadosComparecimento = prepararDadosComparecimento(consultas);
    const dadosHorarios = prepararDadosHorarios(consultas);
    const dadosServicos = prepararDadosServicos(consultas);

    // Criar gr√°ficos
    criarGraficoConsultasPeriodo(dadosPorPeriodo);
    criarGraficoComparecimento(dadosComparecimento);
    criarGraficoHorarios(dadosHorarios);
    criarGraficoServicos(dadosServicos);
  }

  function prepararDadosPorPeriodo(consultas) {
    const tipoPeriodo = document.getElementById("tipoPeriodo").value;
    const dados = {};
    
    // Fun√ß√£o para formatar a data de forma mais bonita
    function formatarData(data, tipo) {
        const d = new Date(data);
        const meses = {
            '01': 'Jan', '02': 'Fev', '03': 'Mar', '04': 'Abr',
            '05': 'Mai', '06': 'Jun', '07': 'Jul', '08': 'Ago',
            '09': 'Set', '10': 'Out', '11': 'Nov', '12': 'Dez'
        };

        switch (tipo) {
            case "diario":
                const dia = d.getDate().toString().padStart(2, '0');
                const mes = meses[(d.getMonth() + 1).toString().padStart(2, '0')];
                return `${dia} ${mes}`;
            case "semanal":
                const inicioSemana = new Date(d);
                inicioSemana.setDate(d.getDate() - d.getDay());
                const fimSemana = new Date(inicioSemana);
                fimSemana.setDate(inicioSemana.getDate() + 6);
                
                const diaInicio = inicioSemana.getDate().toString().padStart(2, '0');
                const mesInicio = meses[(inicioSemana.getMonth() + 1).toString().padStart(2, '0')];
                const diaFim = fimSemana.getDate().toString().padStart(2, '0');
                const mesFim = meses[(fimSemana.getMonth() + 1).toString().padStart(2, '0')];
                
                return `${diaInicio} ${mesInicio} - ${diaFim} ${mesFim}`;
            case "mensal":
                const mesNome = meses[(d.getMonth() + 1).toString().padStart(2, '0')];
                return mesNome;
            case "anual":
                return d.getFullYear().toString();
            default:
                const diaPadrao = d.getDate().toString().padStart(2, '0');
                const mesPadrao = meses[(d.getMonth() + 1).toString().padStart(2, '0')];
                return `${diaPadrao} ${mesPadrao}`;
        }
    }
    
    // Agrupar consultas por per√≠odo
    consultas.forEach(consulta => {
        if (!consulta.data) return;
        const dataFormatada = formatarData(consulta.data, tipoPeriodo);
        dados[dataFormatada] = (dados[dataFormatada] || 0) + 1;
    });

    // Ordenar as datas
    const labels = Object.keys(dados).sort((a, b) => {
        if (tipoPeriodo === "semanal") {
            const dataA = new Date(a.split(' - ')[0].split(' ').reverse().join('-'));
            const dataB = new Date(b.split(' - ')[0].split(' ').reverse().join('-'));
            return dataA - dataB;
        } else if (tipoPeriodo === "mensal") {
            const meses = {
                'Jan': 1, 'Fev': 2, 'Mar': 3, 'Abr': 4,
                'Mai': 5, 'Jun': 6, 'Jul': 7, 'Ago': 8,
                'Set': 9, 'Out': 10, 'Nov': 11, 'Dez': 12
            };
            return meses[a] - meses[b];
        } else {
            const dataA = new Date(a.split(' ').reverse().join('-'));
            const dataB = new Date(b.split(' ').reverse().join('-'));
            return dataA - dataB;
        }
    });

    return {
        labels: labels,
        valores: labels.map(label => dados[label])
    };
  }

  function prepararDadosComparecimento(consultas) {
    const agora = new Date();
    let concluidas = 0;
    let agendadas = 0;
    let canceladas = 0;

    consultas.forEach(consulta => {
        if (consulta.status === 'CANCELADA') {
            canceladas++;
        } else {
            const [ano, mes, dia] = consulta.data.split('-').map(Number);
            const [hora, minuto] = consulta.horario.split(':').map(Number);
            const dataHoraConsulta = new Date(ano, mes - 1, dia, hora, minuto);

            if (dataHoraConsulta < agora) {
                concluidas++;
            } else {
                agendadas++;
            }
        }
    });

    return {
        labels: ["Conclu√≠das", "Agendadas", "Canceladas"],
        valores: [concluidas, agendadas, canceladas]
    };
  }

  function prepararDadosHorarios(consultas) {
    const horarios = {};
    consultas.forEach(c => {
      horarios[c.horario] = (horarios[c.horario] || 0) + 1;
    });

    const ordenados = Object.entries(horarios)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 5); // Top 5 hor√°rios

    return {
      labels: ordenados.map(h => h[0]),
      valores: ordenados.map(h => h[1])
    };
  }

  function prepararDadosServicos(consultas) {
    const servicos = {};
    consultas.forEach(c => {
      servicos[c.servico] = (servicos[c.servico] || 0) + 1;
    });

    const ordenados = Object.entries(servicos)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 5); // Top 5 servi√ßos

    return {
      labels: ordenados.map(s => s[0]),
      valores: ordenados.map(s => s[1])
    };
  }

  function criarGraficoConsultasPeriodo(dados) {
    const ctx = document.getElementById("graficoConsultasPeriodo");
    // Definir altura fixa para o canvas
    ctx.style.height = '250px';
    
    new Chart(ctx, {
        type: "bar",
        data: {
            labels: dados.labels,
            datasets: [{
                label: "N√∫mero de Consultas",
                data: dados.valores,
                backgroundColor: "rgba(255, 255, 255, 0.8)",
                borderColor: "rgb(255, 255, 255)",
                borderWidth: 1,
                borderRadius: 5,
                barThickness: 20
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.5,
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    padding: 12,
                    cornerRadius: 8,
                    titleFont: {
                        size: 14,
                        weight: 'bold'
                    },
                    bodyFont: {
                        size: 13
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        stepSize: 1,
                        color: 'white',
                        font: {
                            size: 12
                        }
                    },
                    grid: {
                        color: 'rgba(255, 255, 255, 0.1)'
                    }
                },
                x: {
                    ticks: {
                        color: 'white',
                        font: {
                            size: 11,
                            weight: '500'
                        },
                        padding: 10
                    },
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
  }

  function criarGraficoComparecimento(dados) {
    const ctx = document.getElementById("graficoComparecimento");
    ctx.style.height = '250px';

    new Chart(ctx, {
      type: "pie",
      data: {
        labels: dados.labels,
        datasets: [{
          data: dados.valores,
          backgroundColor: [
            "rgba(255, 255, 255, 0.9)",
            "rgba(255, 255, 255, 0.7)",
            "rgba(255, 255, 255, 0.5)"
          ],
          borderColor: [
            "rgb(255, 255, 255)",
            "rgb(255, 255, 255)",
            "rgb(255, 255, 255)"
          ],
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        aspectRatio: 1.5,
        layout: {
          padding: {
            top: 20,
            bottom: 20
          }
        },
        plugins: {
          legend: {
            position: "bottom",
            align: "center",
            labels: {
              color: 'white',
              padding: 20,
              font: {
                size: 12
              },
              boxWidth: 15,
              boxHeight: 15
            }
          },
          tooltip: {
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            padding: 12,
            cornerRadius: 8,
            callbacks: {
              label: function(context) {
                return `${context.label}: ${context.raw}%`;
              }
            }
          }
        }
      }
    });
  }

  function criarGraficoHorarios(dados) {
    const ctx = document.getElementById("graficoHorarios");
    ctx.style.height = '250px';

    new Chart(ctx, {
      type: "bar",
      data: {
        labels: dados.labels,
        datasets: [{
          label: "N√∫mero de Consultas",
          data: dados.valores,
          backgroundColor: "rgba(255, 255, 255, 0.8)",
          borderColor: "rgb(255, 255, 255)",
          borderWidth: 1,
          borderRadius: 5,
          barThickness: 20
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        aspectRatio: 1.5,
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            padding: 12,
            cornerRadius: 8,
            titleFont: {
              size: 14,
              weight: 'bold'
            },
            bodyFont: {
              size: 13
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              stepSize: 1,
              color: 'white',
              font: {
                size: 12
              }
            },
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            }
          },
          x: {
            ticks: {
              color: 'white',
              font: {
                size: 12
              }
            },
            grid: {
              display: false
            }
          }
        }
      }
    });
  }

  function criarGraficoServicos(dados) {
    const ctx = document.getElementById("graficoServicos");
    ctx.style.height = '250px';

    // Criar uma paleta de brancos com diferentes opacidades
    const cores = [
        'rgba(255, 255, 255, 0.9)',  // Branco mais claro
        'rgba(255, 255, 255, 0.8)',  // Branco claro
        'rgba(255, 255, 255, 0.7)',  // Branco m√©dio-claro
        'rgba(255, 255, 255, 0.6)',  // Branco m√©dio
        'rgba(255, 255, 255, 0.5)'   // Branco m√©dio-escuro
    ];

    new Chart(ctx, {
      type: "pie",
      data: {
        labels: dados.labels,
        datasets: [{
          data: dados.valores,
          backgroundColor: cores,
          borderColor: cores.map(cor => 'rgba(255, 255, 255, 1)'),
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        aspectRatio: 1.5,
        layout: {
          padding: {
            top: 20,
            bottom: 20
          }
        },
        plugins: {
          legend: {
            position: "bottom",
            align: "center",
            labels: {
              color: 'white',
              padding: 20,
              font: {
                size: 12
              },
              boxWidth: 15,
              boxHeight: 15
            }
          },
          tooltip: {
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            padding: 12,
            cornerRadius: 8,
            titleFont: {
              size: 14,
              weight: 'bold'
            },
            bodyFont: {
              size: 13
            }
          }
        }
      }
    });
  }

  function atualizarTabelaConsultas(consultas) {
    const tbody = document.querySelector("#tabelaConsultasBody");
    const filtrosContainer = document.querySelector("#filtrosTabela");
    
    if (!tbody || !filtrosContainer) {
        console.error("Elementos necess√°rios n√£o encontrados");
        return;
    }

    // Armazenar as consultas globalmente para uso nos filtros
    window.consultasAtuais = consultas;

    // Criar filtros se ainda n√£o existirem
    if (!document.getElementById("filtroStatus")) {
        const filtrosHTML = `
            <div class="row mb-3">
                <div class="col-md-3">
                    <label class="form-label text-white">Status</label>
                    <select class="form-select" id="filtroStatus" onchange="aplicarFiltrosTabela()">
                        <option value="">Todos</option>
                        <option value="CONCLU√çDA">Conclu√≠das</option>
                        <option value="AGENDADA">Agendadas</option>
                        <option value="CANCELADA">Canceladas</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label text-white">Dentista</label>
                    <select class="form-select" id="filtroDentista" onchange="aplicarFiltrosTabela()">
                        <option value="">Todos</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label text-white">Servi√ßo</label>
                    <select class="form-select" id="filtroServico" onchange="aplicarFiltrosTabela()">
                        <option value="">Todos</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label text-white">Buscar</label>
                    <input type="text" class="form-control" id="filtroBusca" 
                           placeholder="Buscar por paciente..." 
                           onkeyup="aplicarFiltrosTabela()">
                </div>
            </div>
        `;
        filtrosContainer.innerHTML = filtrosHTML;

        // Preencher op√ß√µes dos filtros
        const dentistas = [...new Set(consultas.map(c => c.dr ? c.dr.split(' - ')[0] : '').filter(Boolean))];
        const servicos = [...new Set(consultas.map(c => c.servico).filter(Boolean))];

        const selectDentista = document.getElementById("filtroDentista");
        const selectServico = document.getElementById("filtroServico");

        dentistas.sort().forEach(dentista => {
            selectDentista.add(new Option(dentista, dentista));
        });

        servicos.sort().forEach(servico => {
            selectServico.add(new Option(servico, servico));
        });
    }

    // Aplicar filtros iniciais
    aplicarFiltrosTabela();
}

function aplicarFiltrosTabela() {
    const tbody = document.querySelector("#tabelaConsultasBody");
    if (!tbody || !window.consultasAtuais) return;

    const filtroStatus = document.getElementById("filtroStatus").value;
    const filtroDentista = document.getElementById("filtroDentista").value;
    const filtroServico = document.getElementById("filtroServico").value;
    const filtroBusca = document.getElementById("filtroBusca").value.toLowerCase();

    const agora = new Date();
    let html = '';
    
    const consultasFiltradas = window.consultasAtuais.filter(consulta => {
        // Determinar status atual
        const [ano, mes, dia] = consulta.data.split('-').map(Number);
        const [hora, minuto] = consulta.horario.split(':').map(Number);
        const dataHoraConsulta = new Date(ano, mes - 1, dia, hora, minuto);
        
        let status = consulta.status;
        if (status !== 'CANCELADA') {
            status = dataHoraConsulta < agora ? 'CONCLU√çDA' : 'AGENDADA';
        }

        // Aplicar filtros
        if (filtroStatus && status !== filtroStatus) return false;
        
        const nomeDentista = consulta.dr ? consulta.dr.split(' - ')[0] : '';
        if (filtroDentista && nomeDentista !== filtroDentista) return false;
        
        if (filtroServico && consulta.servico !== filtroServico) return false;
        
        if (filtroBusca && !consulta.nome?.toLowerCase().includes(filtroBusca)) return false;

        return true;
    });

    // Atualizar contador de resultados
    const contadorResultados = document.getElementById("contadorResultados");
    if (contadorResultados) {
        contadorResultados.textContent = `${consultasFiltradas.length} consulta${consultasFiltradas.length !== 1 ? 's' : ''} encontrada${consultasFiltradas.length !== 1 ? 's' : ''}`;
    }

    // Renderizar tabela
    consultasFiltradas.forEach(consulta => {
        const [ano, mes, dia] = consulta.data.split('-').map(Number);
        const [hora, minuto] = consulta.horario.split(':').map(Number);
        const dataHoraConsulta = new Date(ano, mes - 1, dia, hora, minuto);

        let status = consulta.status;
        if (status !== 'CANCELADA') {
            status = dataHoraConsulta < agora ? 'CONCLU√çDA' : 'AGENDADA';
        }

        const nomeDentista = consulta.dr ? consulta.dr.split(' - ')[0] : '-';

        html += `
            <tr>
                <td>${consulta.data}</td>
                <td>${consulta.horario}</td>
                <td>${consulta.nome || '-'}</td>
                <td>${nomeDentista}</td>
                <td>${consulta.servico || '-'}</td>
                <td>
                    <span class="badge ${getStatusClass(status)}">
                        ${status}
                    </span>
                </td>
            </tr>
        `;
    });

    tbody.innerHTML = html;
}

  function getStatusClass(status) {
    switch (status) {
        case "CONCLU√çDA":
            return "bg-success";
        case "AGENDADA":
            return "bg-primary";
        case "CANCELADA":
            return "bg-danger";
        default:
            return "bg-secondary";
    }
  }

  // Inicializa√ß√£o
  window.onload = () => carregarConteudo('visaoGeral');
</script>

<script>
  window.addEventListener("DOMContentLoaded", function () {
    document.getElementById("login-form-admin")?.addEventListener("submit", async function (e) {
      e.preventDefault();

      const email = document.getElementById("email").value.trim();
      const senha = document.getElementById("senha").value.trim();
      const erroDiv = document.getElementById("mensagemErro");
      erroDiv.classList.add("d-none");

      try {
        const response = await fetch("http://localhost:8080/administrador/administradores");

        if (!response.ok) {
          erroDiv.textContent = "Erro ao buscar administradores.";
          erroDiv.classList.remove("d-none");
          return;
        }

        const admins = await response.json();

        const adminValido = admins.find(adm =>
          adm.email === email && adm.senha === senha
        );

        if (adminValido) {
          localStorage.setItem("nomeAdmin", adminValido.nome);
          window.location.href = "dashboard.html";
        } else {
          erroDiv.textContent = "Usu√°rio ou senha inv√°lidos.";
          erroDiv.classList.remove("d-none");
        }
      } catch (err) {
        erroDiv.textContent = "Erro de conex√£o com o servidor.";
        erroDiv.classList.remove("d-none");
      }
    });
  });
</script>

<!-- MODAL DE EDI√á√ÉO ADICIONADO AO FINAL DO BODY -->
<div class="modal fade" id="modalEditarAdmin" tabindex="-1" aria-labelledby="modalEditarAdminLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalEditarAdminLabel">Editar Administrador</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <div id="mensagemEdicao" class="alert d-none" role="alert"></div>
      
        <input type="hidden" id="editarId">
        <div class="mb-3">
          <label class="form-label">Nome</label>
          <input type="text" class="form-control" id="editarNome">
        </div>
        <div class="mb-3">
          <label class="form-label">Email</label>
          <input type="email" class="form-control" id="editarEmail">
        </div>
        <div class="mb-3">
          <label class="form-label">Data de Nascimento</label>
          <input type="date" class="form-control" id="editarDataNascimento">
        </div>
        <div class="mb-3">
          <label class="form-label">Nova Senha (opcional)</label>
          <input type="password" class="form-control" id="editarSenha">
        </div>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" onclick="salvarEdicao()">Salvar</button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL DE EDI√á√ÉO DE FUNCION√ÅRIO -->
<div class="modal fade" id="modalEditarFuncionario" tabindex="-1" aria-labelledby="modalEditarFuncionarioLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Funcion√°rio</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <div id="mensagemEdicaoFuncionario" class="alert d-none" role="alert"></div>
        <input type="hidden" id="funcEditarId">
        <div class="mb-2"><label>Nome</label><input id="funcEditarNome" type="text" class="form-control"></div>
        <div class="mb-2"><label>CPF</label><input id="funcEditarCpf" type="text" class="form-control"></div>
        <div class="mb-2"><label>CRO</label><input id="funcEditarCro" type="text" class="form-control"></div>
        <div class="mb-2"><label>Email</label><input id="funcEditarEmail" type="email" class="form-control"></div>
        <div class="mb-2"><label>Nova Senha (opcional)</label><input id="funcEditarSenha" type="password" class="form-control"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" onclick="salvarEdicaoFuncionario()">Salvar</button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL DE EDI√á√ÉO DE PACIENTE -->
<div class="modal fade" id="modalEditarPaciente" tabindex="-1" aria-labelledby="modalEditarPacienteLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Paciente</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <div id="mensagemEdicaoPaciente" class="alert d-none" role="alert"></div>
        <input type="hidden" id="pacEditarId">
        <div class="mb-2">
          <label>Nome</label>
          <input id="pacEditarNome" type="text" class="form-control">
        </div>
        <div class="mb-2">
          <label>CPF</label>
          <input id="pacEditarCpf" type="text" class="form-control">
        </div>
        <div class="mb-2">
          <label>Data de Nascimento</label>
          <input id="pacEditarDataNascimento" type="date" class="form-control">
        </div>
        <div class="mb-2">
          <label>Email</label>
          <input id="pacEditarEmail" type="email" class="form-control">
        </div>
        <div class="mb-2">
          <label>Senha</label>
          <input id="pacEditarSenha" type="password" class="form-control" readonly disabled style="background-color: #e9ecef;">
          <small class="text-muted">A senha n√£o pode ser visualizada ou alterada por quest√µes de seguran√ßa.</small>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" onclick="salvarEdicaoPaciente()">Salvar</button>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS necess√°rio para funcionar o modal -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>